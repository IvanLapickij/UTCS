<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:p="http://primefaces.org/ui"
                template="adminTemplate.xhtml">
    <ui:define name="title">UTCS Admin Dashboard</ui:define>
    <ui:define name="content">
        <div class="main-dashboard">
            <p:messages id="messages" globalOnly="true" closable="true" />
            <h:form id="workspacesForm">
                <div class="workspace-container">

                    <ui:repeat value="#{workspaceData.workspaces}" var="ws">
                        						<div class="workspace-card">
							<h:graphicImage library="images" name="#{ws.imageFile}"
								alt="#{ws.name}" class="workspace-image" />

							<!-- View mode -->
							<h:panelGroup rendered="#{not ws.canEdit}">
								<h3>#{ws.name}</h3>
								<p>
									<em>#{ws.roomType}</em>
								</p>
								<p class="description">#{ws.description}</p>
								<p>
									<strong>Capacity:</strong> #{ws.maxCapacity} person(s)
								</p>
								<p>
									<strong>Price:</strong> â‚¬#{ws.price}
								</p>

								<!-- Buttons -->
								<div class="form-actions" style="margin-top: 20px;">
									<!-- UPDATE -->
									<p:commandButton value="UPDATE"
										action="#{workspaceData.editWorkspace(ws)}" update="@form"
										styleClass="btn-update" />

									<!-- DELETE with Confirm framework -->
									<p:commandButton value="DELETE"
										action="#{workspaceData.deleteWorkspace(ws)}" process="@this"
										immediate="true" update="@form :messages"
										styleClass="btn-delete">
										<!-- Must stay static -->
										<p:confirm header="Delete Confirmation"
											message="Are you sure you want to delete this workspace?"
											icon="pi pi-exclamation-triangle" />
										<!-- Pass the workspace name into bean -->
										<f:setPropertyActionListener value="#{ws.name}"
											target="#{workspaceData.selectedWorkspaceName}" />
									</p:commandButton>
								</div>
							</h:panelGroup>

							<!-- Edit mode -->
							<h:panelGroup rendered="#{ws.canEdit}">
								<p:inputText value="#{ws.name}" />
								<p:inputText value="#{ws.description}" />
								<p:selectOneMenu value="#{ws.roomType}">
									<f:selectItem itemLabel="Open Desk Area"
										itemValue="Open Desk Area" />
									<f:selectItem itemLabel="Private Office"
										itemValue="Private Office" />
									<f:selectItem itemLabel="Meeting Pod" itemValue="Meeting Pod" />
									<f:selectItem itemLabel="Conference Room"
										itemValue="Conference Room" />
									<f:selectItem itemLabel="Event Area" itemValue="Event Area" />
								</p:selectOneMenu>
								<p:spinner value="#{ws.maxCapacity}" min="1" max="999" />
								<p:inputText value="#{ws.price}" />
								<div class="actions">
									<p:commandButton value="SAVE"
										action="#{workspaceData.updateWorkspace(ws)}"
										update="@form :messages" />
									<p:commandButton value="CANCEL"
										action="#{workspaceData.cancelEdit(ws)}" immediate="true"
										update="@form" />
								</div>
							</h:panelGroup>
						</div>
                    </ui:repeat>
                </div>

                <!-- One global confirm dialog only -->
				<p:confirmDialog global="true" appendTo="@(body)" showEffect="fade"
					hideEffect="fade" closable="false" modal="true" width="420">


					<p:commandButton type="button" value="Yes, Delete"
						icon="pi pi-check"
						styleClass="ui-confirmdialog-yes ui-button-danger" />
					<p:commandButton type="button" value="No" icon="pi pi-times"
						styleClass="ui-confirmdialog-no ui-button-secondary" />
				</p:confirmDialog>
            </h:form>
        </div> <!-- end main-dashboard -->
    </ui:define>
</ui:composition>
